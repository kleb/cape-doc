
.. This documentation written by TestDriver()
   on 2019-08-28 at 11:43 PDT

Test ``10_runmatrix``
=======================

This test is run in the folder:

    ``/u/wk/ddalle/usr/pycart/test/cape/10_runmatrix/``

and the working folder for the test is

    ``work/``

The commands executed by this test are

    .. code-block:: console

        $ python2 test01_nofile.py
        $ python3 test01_nofile.py

**Included file:** ``test01_nofile.py``

    .. code-block:: python

        #!/usr/bin/env python
        # -*- coding: utf-8 -*-
        
        
        # Third party modules
        import numpy as np
        
        # Import cape module
        import cape.trajectory
        
        # Settings for run matrix
        opts = {
            "Keys":   ["mach", "alpha", "beta", "config"],
            "mach":   1.4,
            "alpha":  np.array([0.0, 4.0, 0.0, 4.0]),
            "beta":   np.array([0.0, 0.0, 4.0, 4.0]),
            "config": "poweroff",
            "Prefix": None,
        }
        
        
        # Test 01: display folder names
        def test01_folder_names():
            # Create run matrix
            x = cape.trajectory.Trajectory(**opts)
            # Status update
            print("01: Folder names")
            # Display folder names
            for fdir in x.GetFolderNames():
                print(fdir)
        
        
        # Test 02: full folder names
        def test02_full_names():
            # Create run matrix
            x = cape.trajectory.Trajectory(**opts)
            # Status update
            print("02: Full folder names")
            # Display folder names
            for fdir in x.GetFullFolderNames():
                print(fdir)
        
        
        # Test 03: total angle of attack
        def test03_alpha_t():
            # Create run matrix
            x = cape.trajectory.Trajectory(**opts)
            # Status update
            print("03: Total angle of attack")
            # Display total angle of attack and roll angle
            for i in range(x.nCase):
                # Get conditions
                aoap = x.GetAlphaTotal(i)
                phip = x.GetPhi(i)
                # Display
                print("aoap = %.2f, phip = %5.2f" % (aoap, phip))
        
        # Test 04: fixed format
        def test04_format():
            # Create run matrix with extra option
            x = cape.trajectory.Trajectory(
                Definitions={
                    "mach": {"Format": "%.2f"},
                    "alpha": {"Abbreviation": "_a"},
                },
                **opts)
            # Status update
            print("04: Modified format")
            # Display folder names of case 2
            frun = x.GetFolderNames(2)
            # Display it
            print(frun)
        
        # Test 05: conditions file
        def test05_conditions_json():
            # Create run matrix
            x = cape.trajectory.Trajectory(**opts)
            # Status update
            print("05: Conditions JSON file")
            # Write conditions file for case 1
            x.WriteConditionsJSON(1)
            # Read the file
            lines = open("conditions.json").readlines()
            # Display stripped lines
            for line in lines:
                # Strip trailing white space
                line = line.rstrip()
                # Skip empty lines
                if line == "": continue
                # Display it
                print(line)
            
        
        
        if __name__ == "__main__":
            test01_folder_names()
            test02_full_names()
            test03_alpha_t()
            test04_format()
            test05_conditions_json()
        

Command 1: Run Matrix w/o File: Python 2
-----------------------------------------

:Command:
    .. code-block:: console

        $ python2 test01_nofile.py

:Return Code:
    * **PASS**
    * Output: ``0``
    * Target: ``0``
:Time Taken:
    * **PASS**
    * Command took 0.35999 seconds
    * Cumulative time: 0.35999 seconds
:STDOUT:
    * **PASS**
    * Target:

      .. code-block:: none

        01: Folder names
        m1.4a0.0b0.0
        m1.4a4.0b0.0
        m1.4a0.0b4.0
        m1.4a4.0b4.0
        02: Full folder names
        poweroff/m1.4a0.0b0.0
        poweroff/m1.4a4.0b0.0
        poweroff/m1.4a0.0b4.0
        poweroff/m1.4a4.0b4.0
        03: Total angle of attack
        aoap = 0.00, phip =  0.00
        aoap = 4.00, phip =  0.00
        aoap = 4.00, phip = 90.00
        aoap = 5.65, phip = 45.07
        04: Modified format
        m1.40_a0.0b4.0
        05: Conditions JSON file
        {
         "mach": 1.4,
         "alpha": 4.0,
         "beta": 0.0,
         "config": "poweroff"
        }
        

:STDERR:
    * **PASS**

Command 2: Run Matrix w/o File: Python 3
-----------------------------------------

:Command:
    .. code-block:: console

        $ python3 test01_nofile.py

:Return Code:
    * **PASS**
    * Output: ``0``
    * Target: ``0``
:Time Taken:
    * **PASS**
    * Command took 0.629749 seconds
    * Cumulative time: 0.989739 seconds
:STDOUT:
    * **PASS**
    * Target:

      .. code-block:: none

        01: Folder names
        m1.4a0.0b0.0
        m1.4a4.0b0.0
        m1.4a0.0b4.0
        m1.4a4.0b4.0
        02: Full folder names
        poweroff/m1.4a0.0b0.0
        poweroff/m1.4a4.0b0.0
        poweroff/m1.4a0.0b4.0
        poweroff/m1.4a4.0b4.0
        03: Total angle of attack
        aoap = 0.00, phip =  0.00
        aoap = 4.00, phip =  0.00
        aoap = 4.00, phip = 90.00
        aoap = 5.65, phip = 45.07
        04: Modified format
        m1.40_a0.0b4.0
        05: Conditions JSON file
        {
         "mach": 1.4,
         "alpha": 4.0,
         "beta": 0.0,
         "config": "poweroff"
        }
        

:STDERR:
    * **PASS**

